2014-06-03  Andreas Schwab  <schwab@suse.de>

  * SECURITY UPDATE: getaddrinfo writes to random file descriptors under
    high load
    - debian/patches/any/cvs-resolv-reuse-fd.diff: reload file descriptor
      after calling reopen in resolv/res_send.c.
    - CVE-2013-7423

	[BZ #15946]
	* resolv/res_send.c (send_dg): Reload file descriptor after
	calling reopen.

Index: b/libc/resolv/res_send.c
===================================================================
--- a/libc/resolv/res_send.c	2015-02-25 09:09:49.707361749 -0500
+++ b/libc/resolv/res_send.c	2015-02-25 09:09:49.691361625 -0500
@@ -1342,6 +1342,7 @@
 					retval = reopen (statp, terrno, ns);
 					if (retval <= 0)
 						return retval;
+					pfd[0].fd = EXT(statp).nssocks[ns];
 				}
 			}
 			goto wait;
